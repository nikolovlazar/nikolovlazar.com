---
import MainLayout from '@/layouts/MainLayout.astro';
import { getFormattedDate } from '@/utils/date';
import { getCollection } from 'astro:content';

const allPosts = (await getCollection('blog')).sort((a, b) => b.data.publishDate.getTime() - a.data.publishDate.getTime());
const blogposts = allPosts.slice(0, 3);
const hasMorePosts = allPosts.length > 3;
---
<MainLayout>
  <div class="hero">
    <div class="hero--text">
      <h1>Hi, my name is Lazar Nikolov.</h1>
      <p>Born in &apos;94. I work at <a target="_blank" rel="external nofollow noopener" href="https://sentry.io/welcome">Sentry.io ↗</a> as a Developer Advocate. I&apos;m a full-stack engineer, a designer, a content creator, and an <a target="_blank" rel="external nofollow noopener" href="https://egghead.io">egghead.io ↗</a> instuctor. Based in Canada.</p>
    </div>
  </div>
  <div class="content-table">
    <div class="content-table--section">
      <h3>Pages</h3>
      <div class="content-table--section-links">
        <a href="/about">About</a>
        <a href="/uses">Uses</a>
        <a href="/clophon">Colophon</a>
      </div>
    </div>
    <div class="content-table--section">
      <h3>Courses</h3>
      <div class="content-table--section-list">
        <div class="content-table--list-item">
          <a href="#">Fundamental Next.js API and Patterns</a>
          <p>16 lessons</p>
        </div>
        <div class="content-table--list-item">
          <a href="#">Build a Modern User Interface with Chakra UI↗︎</a>
          <p>16 lessons</p>
        </div>
      </div>
    </div>
    <div class="content-table--section">
      <h3>Writing</h3>
      <div class="content-table--section-list">
        {blogposts.map((post) => post.data.isExternal ? (
          <div class="content-table--list-item">
            <a class="content-table--item-title" href={post.data.externalUrl}>{post.data.title}↗︎</a>
            <p>{getFormattedDate(post.data.publishDate)}</p>
          </div>
        ) : (
          <div class="content-table--list-item">
            <a class="content-table--item-title" href={`/blog/${post.slug}`}>{post.data.title}</a>
            <p>{getFormattedDate(post.data.publishDate)}</p>
          </div>
        ))}
        {hasMorePosts && (
          <a href="/blog" class="see-more">See more →︎</a>
        )}
      </div>
    </div>
    <div class="content-table--section">
      <h3>Talks</h3>
      <div class="content-table--section-list">
        <div class="content-table--list-item">
          <a href="#">Fundamental Next.js API and Patterns</a>
          <p>16 lessons</p>
        </div>
        <div class="content-table--list-item">
          <a href="#">Fundamental Next.js API and Patterns</a>
          <p>16 lessons</p>
        </div>
      </div>
    </div>
    <div class="content-table--section">
      <h3>Videos</h3>
      <div class="content-table--section-list">
        <div class="content-table--list-item">
          <a href="#">Fundamental Next.js API and Patterns</a>
          <p>16 lessons</p>
        </div>
        <div class="content-table--list-item">
          <a href="#">Fundamental Next.js API and Patterns</a>
          <p>16 lessons</p>
        </div>
      </div>
    </div>
    <div class="content-table--section">
      <h3>Social</h3>
      <div class="content-table--section-links">
        <a href="/about">About</a>
        <a href="/uses">Uses</a>
        <a href="/clophon">Colophon</a>
      </div>
    </div>
  </div>
</MainLayout>

<style>
  .hero {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    margin-bottom: 60px;
  }

  .hero--text {
    display: flex;
    flex-direction: column;
    row-gap: 16px;
    grid-column-start: 2;
    grid-column-end: 4;
  }

  h1 {
    font-size: var(--fontSizes-2xl);
  }

  .content-table {
    display: grid;
    margin-bottom: 88px;
  }

  .content-table h3 {
    font-weight: normal;
  }

  .content-table--section {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    border-top: 1px solid var(--colors-foreground);
    padding: 10px 8px;
  }

  .content-table--section:last-of-type {
    border-bottom: 1px solid var(--colors-foreground);
  }

  .content-table--section > div {
    grid-column-start: 2;
    grid-column-end: 4;
  }

  .content-table--section-links {
    display: flex;
    justify-content: space-between;
  }

  .content-table--section-list {
    display: flex;
    flex-direction: column;
    row-gap: 12px;
  }

  .content-table--list-item {
    display: flex;
    justify-content: space-between;
  }

  .content-table--list-item a {
    margin-right: 6px;
    white-space: nowrap;
    overflow-x: hidden;
    text-overflow: ellipsis;
  }

  .content-table--list-item p {
    flex-shrink: 0;
    flex-grow: 1;
    display: flex;
    align-items: baseline;
  }

  .content-table--list-item p::before {
    content: '';
    flex: 1;
    display: inline-flex;
    margin-right: 6px;
    border-bottom: 2px dotted var(--colors-foreground);
  }

  .content-table--item-title {
    white-space: nowrap;
    text-overflow: ellipsis;
  }

  .see-more {
    font-weight: 600;
    color: var(--colors-purple);
  }

  @media (max-width: 768px) {
    .hero {
      display: flex;
      flex-direction: column;
      margin-bottom: 24px;
    }

    .content-table {
      margin-bottom: 24px;
    }

    .content-table--section {
      display: flex;
      flex-direction: column;
      row-gap: 6px;
    }

    .content-table--section-links {
      flex-direction: column;
      row-gap: 6px;
    }

    .content-table--section-list {
      row-gap: 16px;
    }

    .content-table--list-item {
      display: flex;
      flex-direction: column;
    }

    .content-table--list-item p::before {
      display: none;
    }
  }


</style>
